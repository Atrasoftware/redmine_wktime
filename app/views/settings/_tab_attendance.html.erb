<script type="text/javascript"> 
attendanceAlertMsg = "<%= l(:text_are_you_sure) %>";
selectListAlertMsg = "<%=l(:label_wk_select_break_time) %>";
</script>
<fieldset class="box tabular">
	<legend><%= l(:label_wk_attendance) %></legend>
	<p>
	<%= check_box_tag('settings[wktime_work_time_header]', 1, @settings['wktime_work_time_header'].to_i == 1) %> <label><%= l(:label_wk_work_time_header) %></label>
	</p>
	<p>
	<%= check_box_tag('settings[wktime_enable_clock_in_out]', 1, @settings['wktime_enable_clock_in_out'].to_i == 1) %> <label><%= l(:label_wk_enable_clock_in_out) %></label>
	</p>
	<p>
		<%
		breakTime = []
		if(@settings['wktime_break_time'].blank?)
			breakTime = ''
		else
			@settings['wktime_break_time'].each do |element|
			  listboxArr = element.split('|')
			  fromHr = listboxArr[0].to_i>9 ? listboxArr[0].strip  : "0"+listboxArr[0].strip
			  fromMin = listboxArr[1].to_i>9 ? listboxArr[1].strip : "0"+listboxArr[1].strip
			  toHr = listboxArr[2].to_i>9 ? listboxArr[2].strip : "0"+listboxArr[2].strip
			  toMin = listboxArr[3].to_i>9 ? listboxArr[3].strip : "0"+listboxArr[3].strip
			  optionText = fromHr + ":"  + fromMin + " - "  + toHr + ":"  + toMin
			  breakTime << [optionText,element]
			end
		end
		%>
	<label><%= l(:label_wk_break_time) %></label>
		<%=  select_tag('settings[wktime_break_time]',
			options_for_select(breakTime, :selected => 'settings[wktime_break_time]'), :multiple=> true, :style => "width:200px; height:150px;")%>	

	</p>			
	<p>
		<%= link_to "Add", "javascript:showBreakTimeDialog('Add');", :class => "button"%>  |
		<%= link_to "Edit", "javascript:showBreakTimeDialog('Edit');", :class => "button"%>  |
		<%= link_to "Delete", "javascript:removeSelectedValue('settings_wktime_break_time');", :class => "button" %>
	</p>
	
	<div id="breaktime-dlg" title="<%= l(:label_wk_break_time) %>">
		<p>
			<label><%= l(:label_date_from) %></label><span style="margin-left:0.5em;"></span>
			<%
			hr = []
			min = []
			for i in 0..23
				if i < 10
					hr << ['0' + i.to_s,i]
				else
					hr << [i,i]
				end
			end
			i = 0
			num = 5

			until i > 55  do
				if i < 10
					min << ['0' + i.to_s,i]
				else
					min << [i,i]
				end
			
			   i +=5;
			end
			%>
			<%= select_tag('settings[wktime_break_from_hr]', options_for_select(hr, 
			:selected => @settings['wktime_break_from_hr'].blank? ? 23 : @settings['wktime_break_from_hr']))%>&nbsp<%= l(:field_hours) %>&nbsp;	
			<%= select_tag('settings[wktime_break_from_min]', options_for_select(min, 
			:selected => @settings['wktime_break_from_min'].blank? ? 0 : @settings['wktime_break_from_min']))%>&nbsp<%= l(:label_wk_minutes) %>								   	
		</p>
		<p>
			<span style="margin-left:1.1em;"></span><label><%= l(:label_date_to) %></label><span style="margin-left:0.5em;"></span>
			<%= select_tag('settings[wktime_break_to_hr]', options_for_select(hr, 
			:selected => @settings['wktime_break_to_hr'].blank? ? 23 : @settings['wktime_break_to_hr']))%>&nbsp<%= l(:field_hours) %>&nbsp;	
			<%= select_tag('settings[wktime_break_to_min]', options_for_select(min,
			:selected => @settings['wktime_break_to_min'].blank? ? 0 : @settings['wktime_break_to_min']))%>&nbsp<%= l(:label_wk_minutes) %>								   	
		</p>
		<p>
			<%= hidden_field_tag :hdnAction, "" %>
		</p>
	</div>
	
	<p>
		<%
		leave = []
		if(@settings['wktime_leave'].blank?)
			leave = ''
		else
			@settings['wktime_leave'].each do |element|
			  listboxArr = element.split('|')
			  issueId = listboxArr[0]
			  issueName = listboxArr[1]
			  leaveAccural = listboxArr[2]
			  optionText = issueName + ":"  + leaveAccural + " " + l(:label_per_month);
			  leave << [optionText,element]
			end
		end
		%>
		<label><%= l(:label_wk_leave) %></label>
			<%=  select_tag('settings[wktime_leave]',
				options_for_select(leave, :selected => 'settings[wktime_leave]'), :multiple=> true, :style => "width:200px; height:150px;")%>	

		</p>			
		<p>
			<%= link_to "Add", "javascript:showLeaveDialog('Add');", :class => "button"%>  |
			<%= link_to "Edit", "javascript:showLeaveDialog('Edit');", :class => "button"%>  |
			<%= link_to "Delete", "javascript:removeSelectedValue('settings_wktime_leave');", :class => "button" %>
		</p>
	
	<div id="leave-dlg" title="<%= l(:label_wk_leave) %>">
		<p>
			<label><%= l(:label_wk_leave_issue) %></label><span style="margin-left:0.5em;"></span>
			
	
			<%
				issue_list = Issue.order('subject')
				unless issue_list.blank?
					issueslist = issue_list.collect {|issue| [issue.subject, issue.id] }
					issueslist.unshift(["",0])
				end
			%>
			<%=h select_tag('settings[wktime_leave_issue]', 
			options_for_select(issueslist, :selected =>  @settings['wktime_leave_issue'])) %>								   	
		</p>
		<p>
			<span style="margin-left:2.5em;"></span><label><%= l(:label_wk_leave_accural) %></label><span style="margin-left:0.5em;"></span><%= text_field_tag('leave_accural','',:size => 14, :maxlength => 3) %> 		
		</p>
		<p>
			<%= hidden_field_tag :hdnAction, "" %>
		</p>
	</div>
	<p>
		<label><%= l(:label_wk_leave_accrual_after) %></label><%= text_field_tag 'settings[wktime_leave_accrual_after]', @settings['wktime_leave_accrual_after'], :size => 3 %>&nbsp<%= l(:label_year) %>
	</p>
</fieldset>